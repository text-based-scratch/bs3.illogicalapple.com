const $=(...e)=>document.querySelector(...e);var caretPosition=[21,0],code=["load assets/empty.svg"],caretAnimationTimeoutID=null,indentation=0,dragElement=null,insertFileAt=null,projectFiles=[{name:"Untitled Project",folder:!0,children:[{name:"assets",folder:!0,children:[{name:"empty.svg",type:"image/svg+xml",data:"data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSIwIiBoZWlnaHQ9IjAiIHZpZXdCb3g9IjAsMCwwLDAiPjxnIGRhdGEtcGFwZXItZGF0YT0ieyZxdW90O2lzUGFpbnRpbmdMYXllciZxdW90Ozp0cnVlfSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJub256ZXJvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWRhc2hhcnJheT0iIiBzdHJva2UtZGFzaG9mZnNldD0iMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIGZvbnQtc2l6ZT0iMTIiIHRleHQtYW5jaG9yPSJzdGFydCIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOiBub3JtYWwiLz48L3N2Zz4="}]}]}],project={targets:[{name:"Sprite1",code:"",stage:!1},{name:"Stage",code:"",stage:!0}],assets:[],_:{activeSprite:0}};function toKebabCase(e){return e.replace(/\s/g,"-").toLowerCase()}function indent(e){code[caretPosition[1]]="  ".repeat(e)+code[caretPosition[1]],caretPosition[0]+=2*e}function updateFiles(){let e=$("ul.root-folder");$("span.project-name").innerText=toKebabCase(projectFiles[0].name),e.replaceChildren(),function e(t,i,a){t.forEach(((t,n)=>{if(t.folder){let o=document.createElement("li"),r=document.createElement("ul");o.classList.add("file","folder-wrapper","file-target"),r.classList.add("folder"),e(t.children,r,a.concat([n])),o.append(toKebabCase(t.name),r),i.append(o)}else{let e=document.createElement("li");e.classList.add("file"),e.dataset.path=a.concat([n]).join(),e.dataset.type=t.type,e.append(t.name),i.append(e)}}))}(projectFiles[0].children,e,[]),project.assets=projectFiles[0].children}function inputHandler(e){let t=document.createElement("div"),i=$("div.contenteditable").innerText.substring(0,$("div.contenteditable").innerText.length-1),a=$("div.text-editor pre.text");a.replaceChildren(),t.classList.add("caret","animation"),"\n"==i&&(":"==[...code[caretPosition[1]]].pop()&&indentation++,caretPosition[1]++,caretPosition[0]=0,code.push(""),i="",indent(indentation)),code.forEach(((e,n)=>{let o=document.createElement("div");o.classList.add("line"),o.dataset.lineId=n,a.append(o),n==caretPosition[1]?(o.classList.add("active"),o.append(t),o.insertBefore(document.createTextNode(e.substring(0,caretPosition[0])),t),o.insertBefore(document.createTextNode(i),t),o.append(document.createTextNode(e.substring(caretPosition[0])))):o.append(document.createTextNode(e))})),code[caretPosition[1]]=code[caretPosition[1]].substring(0,caretPosition[0])+i+code[caretPosition[1]].substring(caretPosition[0]),caretPosition[0]+=i.length,pauseCaret(),$("div.contenteditable").innerHTML="&nbsp;",autocomplete(),format(),project.targets[project._.activeSprite].code=code.join("\n")}function pauseCaret(){$("div.text-editor div.caret").classList.contains("animation")&&($("div.text-editor div.caret").classList.remove("animation"),caretAnimationTimeoutID&&clearTimeout(caretAnimationTimeoutID),caretAnimationTimeoutID=setTimeout((()=>$("div.text-editor div.caret").classList.add("animation")),500))}addEventListener("load",(function(){updateFiles(),$("div.text-editor pre.text").addEventListener("click",(()=>{inputHandler(),pauseCaret(),$("div.contenteditable").focus()})),$("div.contenteditable").addEventListener("input",inputHandler),$("div.text-editor pre.text").addEventListener("scroll",autocomplete),$("div.contenteditable").addEventListener("keydown",(e=>{"Tab"==e.key?(e.preventDefault(),indentation++,indent(1),inputHandler()):"ArrowLeft"==e.key?(caretPosition[0]>0?caretPosition[0]--:caretPosition[1]>0&&(caretPosition[1]--,caretPosition[0]=code[caretPosition[1]].length),inputHandler()):"ArrowRight"==e.key?(caretPosition[0]<code[caretPosition[1]].length?caretPosition[0]++:caretPosition[1]<code.length-1&&(caretPosition[1]++,caretPosition[0]=0),inputHandler()):"ArrowUp"==e.key?(caretPosition[1]>0?(caretPosition[1]--,caretPosition[0]=Math.min(caretPosition[0],code[caretPosition[1]].length)):caretPosition=[0,0],inputHandler()):"ArrowDown"==e.key?(caretPosition[1]<code.length-1?(caretPosition[1]++,caretPosition[0]=Math.min(caretPosition[0],code[caretPosition[1]].length)):caretPosition=[code[code.length-1].length,code.length-1],inputHandler()):"Backspace"==e.key?caretPosition[0]>0?(code[caretPosition[1]]=code[caretPosition[1]].substring(0,caretPosition[0]-1)+code[caretPosition[1]].substring(caretPosition[0]),caretPosition[0]--,indentation=/([\s\u00A0]{2})+/.exec(code[caretPosition[1]])?/([\s\u00A0]{2})+/.exec(code[caretPosition[1]])[0].length/2:0,inputHandler()):caretPosition[1]>0&&(caretPosition[0]=code[caretPosition[1]-1].length,code[caretPosition[1]-1]+=code[caretPosition[1]],code.splice(caretPosition[1],1),caretPosition[1]--,indentation=/([\s\u00A0]{2})+/.exec(code[caretPosition[1]])?/([\s\u00A0]{2})+/.exec(code[caretPosition[1]])[0].length/2:0,inputHandler()):"Delete"==e.key&&caretPosition[0]<code[caretPosition[1]].length&&(code[caretPosition[1]]=code[caretPosition[1]].substring(0,caretPosition[0])+code[caretPosition[1]].substring(caretPosition[0]+1),indentation=/([\s\u00A0]{2})+/.exec(code[caretPosition[1]])?/([\s\u00A0]{2})+/.exec(code[caretPosition[1]])[0].length/2:0,inputHandler())})),$("div.files").addEventListener("click",(e=>{e.target.matches("div.files span.project-name, li.folder-wrapper")&&e.target.toggleAttribute("data-closed")})),$("div.files").addEventListener("dragenter",(e=>{console.log(e.dataTransfer.items[0].getAsFile()),dragElement=e.target,e.preventDefault(),dragElement.classList.add("file-drag"),$("div.files").style.setProperty("--filename-to-add",'"[drop to add]"'),insertFileAt=$(":is(.file-drag.folder li:last-child, .file-drag > ul.folder li:last-child, li.file.file-drag:not(.folder-wrapper))")})),$("div.files").addEventListener("dragover",(e=>{dragElement=e.target,e.preventDefault(),dragElement.classList.add("file-drag"),insertFileAt=$(":is(.file-drag.folder li:last-child, .file-drag > ul.folder li:last-child, li.file.file-drag:not(.folder-wrapper))")})),$("div.files").addEventListener("dragleave",(e=>{e.target==dragElement&&(dragElement=null),e.preventDefault(),e.target.classList.remove("file-drag"),insertFileAt=$(":is(.file-drag.folder li:last-child, .file-drag > ul.folder li:last-child, li.file.file-drag:not(.folder-wrapper))")})),$("div.files").addEventListener("drop",(e=>{let t=projectFiles[0];dragElement=null,e.preventDefault(),e.target.classList.remove("file-drag"),insertFileAt.dataset.path.split(",").forEach(((i,a,n)=>{if(a==n.length-1){let a=new FileReader,n=e.dataTransfer.items[0].getAsFile();a.addEventListener("load",(()=>{t.children.splice(i+1,0,{name:n.name,type:n.type,data:a.result}),updateFiles(projectFiles)})),a.readAsDataURL(n)}else t=t.children[i]})),insertFileAt=null})),$("input.title").addEventListener("change",(e=>{projectFiles[0].name=e.target.value,$("span.project-name").innerText=toKebabCase(e.target.value)})),$("button.new-sprite").addEventListener("click",(()=>{let e=1,t=document.createElement("div"),i=document.createElement("div");for(project._.activeSprite=project.targets.length;project.targets.find((t=>t.name=="Sprite"+e));)e++;project.targets.push({name:"Sprite"+e,code:"load assets/empty.svg",stage:!1}),$("div.sprites div.sprite.active").classList.remove("active"),i.append("Sprite"+e),i.classList.add("sprite-name"),t.classList.add("sprite","flex","active"),t.dataset.index=project.targets.length-1,t.append(i),$("div.sprites").append(t),code=["load assets/empty.svg"],caretPosition=[21,0],inputHandler()})),$("div.sprites").addEventListener("click",(e=>{e.target.closest(".sprite")&&($("div.sprites div.sprite.active").classList.remove("active"),e.target.closest(".sprite").classList.add("active"),project._.activeSprite=e.target.closest(".sprite").dataset.index,code=project.targets[project._.activeSprite].code.split("\n"),caretPosition=[code[code.length-1].length,code.length-1],inputHandler())})),inputHandler(),player.loadProjectById(792509530)}));
//# sourceMappingURL=index.fc08d817.js.map
